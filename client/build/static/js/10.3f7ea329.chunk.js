webpackJsonp([10],{1526:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),a=n.n(r),o=n(28),i=n(38),l=n(260),u=n(176),s=n(1632),c=n(784),m=function(e){var t=e.company.companyName,n=e.location.pathname;return a.a.createElement(i.c,{query:u.b,variables:{companyName:t}},function(e){var t=e.loading,r=e.error,u=e.data.getEmployees,m=e.networkStatus;return t?a.a.createElement(c.d,null,a.a.createElement("h2",null,"...loading")):4===m?a.a.createElement(c.d,null,a.a.createElement("h2",null,"Refetching!")):r?a.a.createElement(c.b,null,a.a.createElement("h2",null,"Error!: "+r)):u?u.employees?a.a.createElement(i.b,{mutation:l.a},function(e){return"/admin-dashboard/assign/ps"===n?a.a.createElement(s.a,{users:u.employees,update:e,survey:"participant"}):a.a.createElement(s.a,{users:u.employees,update:e,survey:"management"})}):a.a.createElement(c.f,null,a.a.createElement(o.o,{error:!0,header:"no staff available",content:"check that you have created employees before trying to assign surveys"})):void 0})};t.default=m},1632:function(e,t,n){"use strict";function r(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function r(a,o){try{var i=t[a](o),l=i.value}catch(e){return void n(e)}if(!i.done)return Promise.resolve(l).then(function(e){r("next",e)},function(e){r("throw",e)});e(l)}return r("next")})}}function a(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function l(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var u=n(261),s=n.n(u),c=n(0),m=n.n(c),f=n(264),d=(n.n(f),n(784)),p=n(785),v=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),y=function(e){return e.map(function(e){return{key:""+e._id,text:e.firstName+" "+e.lastName+", "+e.email,value:{_id:e._id,companyName:e.companyName,mobile:e.mobile,firstTime:e.firstTime}}})},h=function(e){function t(){var e,n,l,u,c=this;o(this,t);for(var m=arguments.length,f=Array(m),d=0;d<m;d++)f[d]=arguments[d];return n=l=i(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(f))),l.state={done:!1,errors:[],selected:[],notSelected:[],survey:"",filterTerm:""},l.componentDidMount=function(){var e=l.props,t=e.users,n=e.survey;l.setState({selected:y(t.filter(function(e){return e.surveyName===n})),notSelected:y(t.filter(function(e){return e.surveyName!==n})),survey:n})},l.handleAdd=function(e){l.setState(function(t){var n=t.notSelected.filter(function(t){return t.value._id===e})[0];return{notSelected:t.notSelected.filter(function(t){return t.value._id!==e}),selected:[].concat(a(t.selected),[n])}})},l.handleRemove=function(e){l.setState(function(t){var n=t.selected.filter(function(t){return t.value._id===e})[0];return{selected:t.selected.filter(function(t){return t.value._id!==e}),notSelected:[].concat(a(t.notSelected),[n])}})},l.submit=r(s.a.mark(function e(){var t;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.props.update({variables:{surveyName:l.state.survey,employees:l.state.selected.map(function(e){return Object.assign({},e.value)})}});case 2:if(t=e.sent,!t.assignSurvey){e.next=5;break}return e.abrupt("return",l.setState({errors:t.assignSurvey.map(function(e){return e.message})}));case 5:l.setState({done:!0});case 6:case"end":return e.stop()}},e,c)})),l.handleSearch=function(e,t){var n=t.value;e.preventDefault();var r=n.toLowerCase();l.setState({filterTerm:r})},l.handleFilter=function(e){return!(!e||!e.hasOwnProperty("text"))&&e.text.toLowerCase().includes(l.state.filterTerm)},u=n,i(l,u)}return l(t,e),v(t,[{key:"render",value:function(){var e=this,t=this.state,n=t.selected,r=t.survey,a=t.done,o=t.errors,i=t.notSelected,l=t.filterTerm,u=l.length>0?n.filter(this.handleFilter):n,s=l.length>0?i.filter(this.handleFilter):i;return a?m.a.createElement(d.f,null,m.a.createElement(f.Message,{info:!0,icon:"inbox",header:r.toUpperCase()+" Survey assigned and SMS messages Sent",content:"All messages have been sent and reminders scheduled"})):o.length>1?m.a.createElement(d.f,null,m.a.createElement(f.Message,{error:!0,header:"There were some errors with your submission",list:o})):m.a.createElement(d.f,null,m.a.createElement(f.Header,{size:"medium"},"ADD USERS TO "+r.toUpperCase()+" SURVEY"),m.a.createElement(p.a,{search:this.handleSearch,placeholder:"find user"}),m.a.createElement(f.List,{animated:!0,divided:!0,verticalAlign:"middle"},s.map(function(t){return m.a.createElement(f.List.Item,{key:t.key+"add"},m.a.createElement(f.List.Content,{floated:"right"},m.a.createElement(f.Button,{positive:!0,onClick:function(){return e.handleAdd(t.key)}},"Add")),m.a.createElement(f.List.Icon,{name:"plus"}),m.a.createElement(f.List.Content,null,m.a.createElement(f.List.Header,null,t.text)))})),m.a.createElement(f.Button,{onClick:this.submit,fluid:!0,primary:!0},"Save & Send SMS"),m.a.createElement(f.Header,{size:"medium"},"REMOVE USERS FROM "+r.toUpperCase()+" SURVEY"),m.a.createElement(f.List,{animated:!0,verticalAlign:"top",size:"medium"},u.map(function(t){return m.a.createElement(f.List.Item,{key:t.key},m.a.createElement(f.List.Content,{floated:"right"},m.a.createElement(f.Button,{negative:!0,onClick:function(){return e.handleRemove(t.key)}},"Remove")),m.a.createElement(f.List.Icon,{name:"close"}),m.a.createElement(f.List.Content,null,m.a.createElement(f.List.Header,null,t.text)))})))}}]),t}(c.Component);h.getDerivedStateFromProps=function(e,t){if(e.survey!==t.survey){var n=e.users,r=e.survey;return{done:!1,errors:[],selected:y(n.filter(function(e){return e.surveyName===r})),notSelected:y(n.filter(function(e){return e.surveyName!==r})),survey:r}}return null},t.a=h}});
//# sourceMappingURL=10.3f7ea329.chunk.js.map