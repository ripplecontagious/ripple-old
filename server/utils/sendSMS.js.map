{"version":3,"sources":["../../../src/server/utils/sendSMS.js"],"names":["controller","sdk","MessagesController","SMS_KEY","SMS_USER","GOOGLE_API_KEY","process","env","Configuration","basicAuthUserName","basicAuthPassword","googl","setKey","getKey","sendSMS","mobile","linkUrl","companyName","firstTime","shortUrl","shorten","body","messageBody","SendMessagesRequest","sms","createSendMessages","err","res"],"mappings":";;;;;;;AACA;;;;AACA;;;;;;AAEA,MAAMA,aAAaC,kCAAIC,kBAAvB;;AAEA,MAAM,EAAEC,OAAF,EAAWC,QAAX,EAAqBC,cAArB,KAAwCC,QAAQC,GAAtD;;AAEAN,kCAAIO,aAAJ,CAAkBC,iBAAlB,GAAsCL,QAAtC,C,CAAgD;AAChDH,kCAAIO,aAAJ,CAAkBE,iBAAlB,GAAsCP,OAAtC,C,CAA+C;;AAE/C;AACAQ,cAAMC,MAAN,CAAaP,cAAb;AACAM,cAAME,MAAN;;AAEA;AACO,MAAMC,4BAAU,OAAOC,MAAP,EAAeC,OAAf,EAAwBC,WAAxB,EAAqCC,SAArC,KAAmD;AACxE,QAAMC,WAAW,MAAMR,cAAMS,OAAN,CAAcJ,OAAd,CAAvB;AACA;AACA;AACA,QAAMK,OAAQ,oFAAmFJ,WAAY,kBAAiBE,QAAS,sBAAvI;;AAEA,QAAMG,cAAc,IAAIrB,kCAAIsB,mBAAR,CAA4B;AAC9C,gBAAY,CACV;AACE,iBAAWF,IADb;AAEE,4BAAsBN,MAFxB;AAGE,gBAAU;AAHZ,KADU;AADkC,GAA5B,CAApB;;AAUA,QAAMS,MAAM,MAAMxB,WAAWyB,kBAAX,CAA8BH,WAA9B,EAA2C,CAACI,GAAD,EAAMC,GAAN,KAAcA,MAAMA,GAAN,GAAYD,GAArE,CAAlB;AACA,SAAOF,GAAP;AACD,CAlBM","file":"sendSMS.js","sourcesContent":["\nimport googl from 'goo.gl'\nimport sdk from 'messagemedia-messages-sdk'\n\nconst controller = sdk.MessagesController\n\nconst { SMS_KEY, SMS_USER, GOOGLE_API_KEY } = process.env\n\nsdk.Configuration.basicAuthUserName = SMS_USER; // Your API Key\nsdk.Configuration.basicAuthPassword = SMS_KEY; // Your Secret Key\n\n// Setup for Google URL Shortner\ngoogl.setKey(GOOGLE_API_KEY);\ngoogl.getKey();\n\n// SMS service\nexport const sendSMS = async (mobile, linkUrl, companyName, firstTime) => {\n  const shortUrl = await googl.shorten(linkUrl)\n  // const firstBody = `${companyName} has engaged the use of Ripple to be implemented as an easy and efficient device that promotes positive behaviour in your organisation and has been customised specifically to suit the needs of your professional environment. Please click ${shortUrl} and commence completion of this survey`\n  // const secondBody = `Ripple â€“ Contagious Attitude notification â€“ Survey required! Please click ${shortUrl} to commence completion`\n  const body = `Welcome to Ripple. This is your periodic link to complete the survey approved by ${companyName}. Please click ${shortUrl} to complete Ripple.`\n\n  const messageBody = new sdk.SendMessagesRequest({\n    \"messages\": [\n      {\n        \"content\": body,\n        \"destination_number\": mobile,\n        \"format\": \"SMS\"\n      }\n    ]\n  })\n\n  const sms = await controller.createSendMessages(messageBody, (err, res) => res ? res : err)\n  return sms\n}\n\n\n\n"]}